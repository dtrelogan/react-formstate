# onChange, onBlur, or onSubmit

You can choose when you'd like to show validation messages. To get a feel for the differences, you can play with the [demo](https://dtrelogan.github.io/react-formstate-demo/).

Start with an underlying stateless input component:

```jsx
export default ({type, label, value, help, onChange, onBlur}) => {
  return (
    <div>
      <div>{label}</div>
      <input type={type || 'text'} value={value} onChange={onChange} onBlur={onBlur}/>
      <div>{help}</div>
    </div>
  );
};
```

## onChange

```jsx
export default ({fieldState, handleValueChange, showValidationMessage, ...other}) => {
  return (
    <Input
      value={fieldState.getValue()}
      help={fieldState.getMessage()}
      onChange={e => handleValueChange(e.target.value)}
      onBlur={showValidationMessage}
      {...other}
      />
  );
};
```

## onBlur

```diff
export default ({fieldState, handleValueChange, showValidationMessage, ...other}) => {
  return (
    <Input
      value={fieldState.getValue()}
+     help={fieldState.isMessageVisible() ? fieldState.getMessage() : null}
      onChange={e => handleValueChange(e.target.value)}
      onBlur={showValidationMessage}
      {...other}
      />
  );
};
```

## onSubmit

```diff
export default ({fieldState, handleValueChange, showValidationMessage, ...other}) => {
  return (
    <Input
      value={fieldState.getValue()}
+     help={fieldState.isMessageVisible() ? fieldState.getMessage() : null}
      onChange={e => handleValueChange(e.target.value)}
+     onBlur={() => {}}
      {...other}
      />
  );
};
```

## Changing the behavior of FormState.isInvalid

For onBlur and onSubmit, in your form component, you can pass 'true' to FormState.isInvalid to factor in "visible" messages only:

```jsx
<input type='submit' value='Submit' disabled={this.formState.isInvalid(true)}/>
```

## Dynamic configuration

Sometimes different forms are better suited to different user experiences. For instance, in the [demo login form](https://dtrelogan.github.io/react-formstate-demo/?form=login), it might make sense to show messages onSubmit. The react-formstate API provides some built-in support for dynamic configuration:

```jsx
export default ({formState, fieldState, handleValueChange, showValidationMessage, ...other}) => {

  let help = null;

  if (fieldState.isMessageVisible() || !(formState.showMessageOnBlur() || formState.showMessageOnSubmit())) {
    help = fieldState.getMessage();
  }

  return (
    <Input
      value={fieldState.getValue()}
      help={help}
      onChange={e => handleValueChange(e.target.value)}
      onBlur={formState.showMessageOnSubmit() ? () => {} : showValidationMessage}
      {...other}
      />
  );
};
```

Configuring behavior globally:

```es6
import { FormState } from 'react-formstate';

// defaults to show onChange behavior

FormState.setShowMessageOnBlur(true);
FormState.setShowMessageOnSubmit(true); // supercedes onBlur

// behavior of FormState.isInvalid automatically adjusts accordingly

FormState.setEnsureValidationOnBlur(true); // explained below

```

Overriding locally:

```es6
constructor(props) {
  super(props);
  this.formState = new FormState(this);

  // override global settings on FormState

  this.formState.setShowMessageOnBlur(false);
  this.formState.setShowMessageOnSubmit(false);
  this.formState.setEnsureValidationOnBlur(false);
}
```

You could also override the behavior on a per-input basis in a variety of ways.

## ensureValidationOnBlur

The best way to understand what this does is to play with the [demo](https://dtrelogan.github.io/react-formstate-demo/). Blur through some inputs without changing them, then toggle the ensure validation onBlur setting and repeat.

## Overriding showValidationMessage

Like 'handleValueChange', 'showValidationMessage' is another standard handler prop generated by react-formstate. You can always override it if necessary:

```jsx
<Input formField='name' showValidationMessage={this.customBlurHandler}/>
```

```es6
// this is what the standard react-formstate generated blur handler does
customBlurHandler() {
  const context = this.formState.createUnitOfWork();
  const fieldState = context.getFieldState('someField');

  if (this.formState.ensureValidationOnBlur() && !fieldState.isValidated()) {
    fieldState.validate();
  }

  fieldState.showMessage(); // mark the message "visible"
  context.updateFormState();
}
```
